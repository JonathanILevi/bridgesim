<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

<link rel="import" href="../bower_components/iron-page-url/iron-page-url.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html">

<link rel="import" href="deps.html">
<link rel="import" href="input.html">
<link rel="import" href="map.html">
<link rel="import" href="nav.html">
<link rel="import" href="thrust.html">
<link rel="import" href="power.html">
<link rel="import" href="lobby.html">

<dom-module id="bridgesim-game">
  <template>
    <iron-page-url query="{{urlQuery}}"></iron-page-url>

    <bridgesim-input id="input" ship="[[ship]]"></bridgesim-input>

    <style include="iron-flex iron-flex-alignment"></style>
    <style>
      :host {
        display: block;
        font-family: roboto;
        background-color: #000;
      }
      #header {
        background-color: #fff;
      }
      #header * {
        margin: 10px;
      }
      #panels {
        padding: 10px;
      }
      #panels * {
        padding: 0 10px 20px 0;
      }
      paper-toggle-button {
        cursor: pointer;
      }
      .token {
        border: 1px solid #ccc;
        word-wrap: break-word;
        padding: 5px;
        margin: 20px;
        width: 500px;
        height: 50px;
        cursor: pointer;
        resize: none;
      }
      bridgesim-lobby {
        width: 776px;
        height: 75px;
      }
    </style>

    <section id="header" class="layout horizontal center">
      <h1>BRIDGESIM</h1>
      <paper-button disabled$="[[isHost]]" on-tap="joinGame">
        Join Game</paper-button>
      <paper-button disabled$="[[isClient]]" on-tap="invitePlayer">
        Invite Player</paper-button>
      <paper-toggle-button checked="{{isHost}}">HOST</paper-toggle-button>
    </section>

    <paper-dialog id="joinDialog" on-iron-overlay-closed="clearTokens">
      <h2>send this offer to the server:</h2>
      <textarea class="token" on-tap="selectAndCopy">[[copyOffer]]</textarea>
      <h2>paste the answer here:</h2>
      <textarea class="token" value="{{pasteAnswer::input}}"></textarea>
    </paper-dialog>

    <paper-dialog id="inviteDialog" on-iron-overlay-closed="clearTokens">
      <h2>paste the player's offer here:</h2>
      <textarea class="token" value="{{pasteOffer::input}}"></textarea>
      <h2>send back this answer:</h2>
      <textarea class="token" on-tap="selectAndCopy">[[copyAnswer]]</textarea>
    </paper-dialog>

    <section id="panels" class="layout vertical">
      <bridgesim-lobby id="lobby" on-send-chat="sendChat"></bridgesim-lobby>
      <div class="layout horizontal">
        <bridgesim-map id="map" size="[[size]]"
          ships="[[ships]]" ship="[[ship]]"> </bridgesim-map>
        <div class="layout vertical justified">
          <div>
            <bridgesim-nav id="nav" ship="[[ship]]"></bridgesim-nav>
            <bridgesim-thrust id="thrust" ship="[[ship]]"></bridgesim-thrust>
          </div>
          <bridgesim-power id="power" ship="[[ship]]"></bridgesim-power>
        </div>
      </div>
    </section>
  </template>

  <script src="game.js"></script>
</dom-module>
