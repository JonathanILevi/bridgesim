<link href='https://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>

<link rel="import" href="../bower_components/iron-location/iron-location.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html">

<link rel="import" href="./deps.html">
<link rel="import" href="./input.html">
<link rel="import" href="./chat.html">
<link rel="import" href="./settings-menu.html">
<link rel="import" href="./lobby.html">
<link rel="import" href="./peer-localstorage.html">
<link rel="import" href="./peer-copypaste.html">

<link rel="import" href="./stations/comms.html">
<link rel="import" href="./stations/engineering.html">
<link rel="import" href="./stations/helm.html">
<link rel="import" href="./stations/science.html">
<link rel="import" href="./stations/weapons.html">
<link rel="import" href="./stations/viewscreen.html">

<dom-module id="bridgesim-game">
  <template>
    <iron-location query="{{urlQuery}}"></iron-location>

    <bridgesim-peer-localstorage
      id="peerLocalstorage"
      is-host="[[isHost]]"
      on-connection="onConnection">
    </bridgesim-peer-localstorage>

    <bridgesim-peer-copypaste
      id="peerCopypaste"
      on-connection="onConnection">
    </bridgesim-peer-copypaste>

    <bridgesim-input id="input" ship="[[ship]]"></bridgesim-input>

    <style include="iron-flex iron-flex-alignment"></style>
    <style>
      :host {
        display: block;
        background-color: #000;
        color: #fff;

        --bridgesim-font: {
          font-family: 'Share Tech Mono';
        };
        @apply(--bridgesim-font);
        --paper-font-common-base: {
          @apply(--bridgesim-font);
        };
        --paper-button: {
          @apply(--bridgesim-font);
        }
        --paper-dialog: {
          @apply(--bridgesim-font);
        }
        --paper-input-container: {
          @apply(--bridgesim-font);
        }
        --paper-input-container-label: {
          @apply(--bridgesim-font);
        }
        --paper-input-suffix: {
          @apply(--bridgesim-font);
        }

        --paper-tab-ink: #7FDBFF;
        --paper-tabs-selection-bar-color: #7FDBFF;
      }
      #header {
        color: black;
        background-color: #fff;
      }
      #header * {
        margin: 10px;
      }
      #panels > * {
        margin: 10px;
      }
      paper-toggle-button {
        cursor: pointer;
      }
      bridgesim-chat {
        margin: 0 !important;
        height: 98px;
      }
    </style>

    <section id="header" class="layout horizontal center">
      <h1>BRIDGESIM</h1>

      <paper-button on-tap="openSettingsDialog">Settings</paper-button>
      <paper-button on-tap="openLobbyDialog">Lobby</paper-button>

      <paper-button disabled$="[[isHost]]" on-tap="joinGame">
        Join Game</paper-button>
      <paper-button disabled$="[[isClient]]" on-tap="invitePlayer">
        Invite Player</paper-button>

      <paper-toggle-button checked="{{isHost}}">HOST</paper-toggle-button>
    </section>

    <paper-dialog id="settingsDialog">
      <bridgesim-settings-menu settings="{{settings}}">
      </bridgesim-settings-menu>
    </paper-dialog>

    <paper-dialog id="lobbyDialog">
      <bridgesim-lobby roster="[[roster]]"
                       on-join-crew="joinCrew"
                       on-create-ship="createShip">
      </bridgesim-lobby>
    </paper-dialog>

    <section id="panels" class="layout vertical">
      <bridgesim-chat id="chat" on-send-chat="sendChat"></bridgesim-chat>
      <paper-tabs selected="{{station}}" attr-for-selected='name'>
        <paper-tab name='helm'>Helm</paper-tab>
        <paper-tab name='comms'>Comms</paper-tab>
        <paper-tab name='science'>Science</paper-tab>
        <paper-tab name='weapons'>Weapons</paper-tab>
        <paper-tab name='engineering'>Engineering</paper-tab>
        <paper-tab name='viewscreen'>Viewscreen</paper-tab>
      </paper-tabs>

      <iron-pages id='stations' selected="[[station]]" attr-for-selected='name'>
        <helm-station name='helm' ship="[[ship]]" ships="[[ships]]" size="[[size]]">
        </helm-station>
        <comms-station name='comms' ship="[[ship]]">
        </comms-station>
        <science-station name='science' ship="[[ship]]">
        </science-station>
        <weapons-station name='weapons' ship="[[ship]]">
        </weapons-station>
        <engineering-station name='engineering' ship="[[ship]]">
        </engineering-station>
        <viewscreen-station name='viewscreen' ship="[[ship]]" ships="[[ships]]" size="[[size]]">
        </viewscreen-station>
      </iron-pages>
    </section>
  </template>

  <script src="game.js"></script>
</dom-module>
