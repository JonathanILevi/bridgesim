<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

<link rel="import" href="../bower_components/iron-page-url/iron-page-url.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html">

<link rel="import" href="deps.html">
<link rel="import" href="input.html">
<link rel="import" href="map.html">
<link rel="import" href="nav.html">
<link rel="import" href="thrust.html">
<link rel="import" href="power.html">
<link rel="import" href="webrtc-server.html">
<link rel="import" href="webrtc-client.html">

<dom-module id="bridgesim-game">
  <template>
    <style>
      :host {
        display: block;
        font-family: roboto;
      }
      h1 {
        margin: 0;
      }
      #main-menu {
        width: 200px;
      }
      paper-toggle-button {
        cursor: pointer;
      }
      .token {
        border: 1px solid #ccc;
        word-wrap: break-word;
        padding: 5px;
        margin: 20px;
        width: 500px;
        height: 50px;
        cursor: pointer;
        resize: none;
      }
    </style>

    <iron-page-url query="{{urlQuery}}"></iron-page-url>

    <h1>Bridgesim</h1>

    <paper-toggle-button checked="{{isServer}}">Server</paper-toggle-button>

    <paper-button disabled$="[[isServer]]" on-tap="joinGame">
      Join Game</paper-button>
    <paper-button disabled$="[[isClient]]" on-tap="invitePlayer">
      Invite Player</paper-button>

    <paper-dialog id="offerDialog">
      <h2>send this offer to the server:</h2>
      <textarea class="token"
        onclick="this.select(); document.execCommand('copy');">[[offer]]</textarea>

      <h2>paste the answer here:</h2>
      <textarea class="token" value="{{answer::input}}"></textarea>
    </paper-dialog>

    <paper-dialog id="inviteDialog">
      <h2>paste the player's offer here:</h2>
      <textarea class="token" value="{{offer::input}}"></textarea>

      <h2>send back this answer:</h2>
      <textarea class="token"
        onclick="this.select(); document.execCommand('copy');">[[answer]]</textarea>
    </paper-dialog>

    <template id="server-menu" is="dom-if" if="[[isClient]]" restamp="true">
      <bridgesim-webrtc-client id="client"></bridgesim-webrtc-client>
    </template>

    <template is="dom-if" if="[[isServer]]" restamp="true">
      <bridgesim-webrtc-server id="server"></bridgesim-webrtc-server>
    </template>

    <br>

    <input id="msg" value="{{msg::change}}">
    <button on-tap="sendMessage">send message</button>
    <br>

    <bridgesim-input id="input" ship="[[ship]]"
      on-next-ship="nextShip" on-prev-ship="prevShip">
    </bridgesim-input>

    <bridgesim-map id="map" size="[[size]]" ships="[[ships]]" ship="[[ship]]">
    </bridgesim-map>

    <bridgesim-nav id="nav" ship="[[ship]]"></bridgesim-nav>
    <bridgesim-thrust id="thrust" ship="[[ship]]"></bridgesim-thrust>
    <bridgesim-power id="power" ship="[[ship]]"></bridgesim-power>
  </template>

  <script src="game.js"></script>
</dom-module>
